"0","Zestimate = Zestimate[with(Zestimate, order(PropertyID, ZestimateAmount,Zestimateyear)), ]"
"0","Home_trans_zestimate$Method = ''"
"0","Home_trans_zestimate$Method = ifelse(is.na(Home_trans_zestimate$Zestimateyear),'Method2','Method1')"
"0","Home_trans_zestimate$Zestimateyear = as.character(Home_trans_zestimate$Zestimateyear )"
"0","Assign_years = function(propertyID,ZestimateOnSaleDate){"
"0","  v = Zestimate[Zestimate$PropertyID == propertyID,3] "
"0","  y = Zestimate[Zestimate$PropertyID == propertyID,4]"
"0","  idx = findInterval(ZestimateOnSaleDate, v)"
"0","  v1 = v[idx]"
"0","  v2 = v[idx+1]"
"0","  "
"0","  if (length(v) == 0){"
"0","    return(""NULL"")"
"0","  }"
"0","  else if (ZestimateOnSaleDate < v[1]){"
"0","    return(paste(""<"",y[1]))"
"0","  }"
"0","  else if (ZestimateOnSaleDate > v[length(v)]){"
"0","    return(paste("">"",y[length(v)]))"
"0","  }"
"0","  else if (ZestimateOnSaleDate - v1 > v2 - ZestimateOnSaleDate){"
"0","    return(as.character(y[idx+1]))"
"0","  }"
"0","  else if (ZestimateOnSaleDate - v1 < v2 - ZestimateOnSaleDate){"
"0","    return(as.character(y[idx]))"
"0","  }"
"0","  else if (ZestimateOnSaleDate - v1 == v2 - ZestimateOnSaleDate){"
"0","    return(paste(""In Between"",y[idx],""and"",y[idx+1]))"
"0","  }"
"0","}"
"0","for (i in 1:nrow(Home_trans_zestimate)) {"
"0","  if (Home_trans_zestimate[i,8] == 'Method2' & !is.na(Home_trans_zestimate$ZestimateOnSaleDate[i]))"
"0","  {Home_trans_zestimate[i,7] = Assign_years(Home_trans_zestimate$PropertyID[i],Home_trans_zestimate$ZestimateOnSaleDate[i])"
"0","  }"
"0","}"
"0","Home2007 = Home_trans_zestimate[Home_trans_zestimate$Zestimateyear %in% c('> 2007','2007'),]"
"0","print(""The 5 most expensive homes are: "")"
"1","[1]"
"1"," ""The 5 most expensive homes are: """
"1","
"
"0","head(arrange(Home2007,desc(SaleAmount)), n = 5)[,1:5]"
